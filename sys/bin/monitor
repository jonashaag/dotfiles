#!/bin/sh
set -e
if [ "$1" = "off" ]; then
  echo Disabling monitor...
  xrandr --output VGA1 --off
  exit
fi
W=$1
H=$2
if [ -z "$W" ]; then W=1680; fi
if [ -z "$H" ]; then H=1050; fi
echo Generating modeline...
MODELINE=$(cvt $W $H | grep Modeline | cut -d ' ' -f 2-)
NAME="${W}x${H}_60.00"
if ! xrandr | grep "$NAME" > /dev/null; then
  echo Adding new mode...
  eval $(echo xrandr --newmode $MODELINE)
fi
echo Assigning new mode...
xrandr --addmode VGA1 $NAME
echo Setting up monitor...
xrandr --output VGA1 --right-of LVDS1 --mode $NAME

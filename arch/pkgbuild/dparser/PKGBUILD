# Contributors: Friedrich Weber <fred@reichbier.de> 
#               Jonas Haag <jonas@lophus.org>

pkgname=dparser
pkgver=1.25
pkgrel=1
pkgdesc="A simple but powerful tool for parsing."
arch=("i686")
url="http://dparser.sourceforge.net"
license=('BSD')
source=(http://github.com/downloads/jonashaag/dparser/d-$pkgver-$pkgrel-src.tar.gz)
md5sums=('7acec850c44f59b6cfe08cf9fd12426e')
optdepends=('swig: Python bindings')

build() {
  cd "$srcdir/"

  msg "Running make..."
  make PREFIX="$pkgdir/usr" || return 1
  make PREFIX="$pkgdir/usr" install || return 1

  # compile Python binding
  if [[ -z $(pacman -Qid swig 2>&1) ]]; then
    msg "Found swig, generating Python bindings..."
    cd python
    make || return 1
    python setup.py install --root="${pkgdir}" --prefix='/usr' || return 1
    cd ..
  else
    msg "swig package not found, skipping Python binding generation"
  fi

  # copy license
  msg "Copying COPYRIGHT ..."
  mkdir -p $pkgdir/usr/share/licenses/dparser || return 1
  cp COPYRIGHT $pkgdir/usr/share/licenses/dparser || return 1
}

# vim:set ts=2 sw=2 et:
